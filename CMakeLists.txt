cmake_minimum_required(VERSION 3.24 FATAL_ERROR)
set(ARCH "x86_64")
cmake_policy(SET CMP0100 NEW)
if(WIN32 OR WIN64)
	add_definitions(-DWINDOWS)
	set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -Wextra -Wpedantic -Wformat-security -Wno-unused -Wno-array-bounds -Wno-stringop-overflow")
	if(CMAKE_BUILD_TYPE MATCHES Release)
		set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -fPIE")
		set(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS}  -Wl,--high-entropy-va -Wl,--dynamicbase -Wl,--nxcompat")
	elseif(CMAKE_BUILD_TYPE MATCHES Debug)
		message(STATUS "Hardening disabled for debug build")
	endif()
elseif(UNIX)
	add_definitions(-DLINUX)
	set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -Wextra -Wpedantic -Wformat-security -Wno-unused -Wno-array-bounds -Wno-stringop-overflow")
	if(CMAKE_BUILD_TYPE MATCHES Release)
		set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -fPIE")
	elseif(CMAKE_BUILD_TYPE MATCHES Debug)
		message(STATUS "Hardening disabled for debug build")
	endif()
elseif(APPLE)
	add_definitions(-DOSX)
endif()
if(CMAKE_BUILD_TYPE MATCHES Release)
	set(CMAKE_CXX_FLAGS_RELEASE "-Ofast")
	add_definitions(-DRELEASE)
elseif(CMAKE_BUILD_TYPE MATCHES Debug)
	set(CMAKE_CXX_FLAGS_DEBUG "-ggdb3 -O0")
	add_definitions(-DDEBUG)
endif()

set(CMAKE_CXX_STANDARD 23)

project(libGLRender)
include_directories(include)
add_library(${PROJECT_NAME} SHARED
		src/gl.c
		src/export.hh
		src/glObjects.cc        src/glObjects.hh
		src/renderer.cc         src/renderer.hh src/utility.cc src/utility.hh)
